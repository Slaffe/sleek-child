<?php
# Enable search inside custom fields (including ACF)
# require_once get_template_directory() . '/inc/include-postmeta-in-search.php';

# Modify WP's built in thumbnail sizes
add_action('after_setup_theme', function () {
	update_option('thumbnail_size_w', 640);
	update_option('thumbnail_size_h', 480);
	update_option('thumbnail_crop', 1); # TODO: Can we set crop to center/top?

	update_option('medium_size_w', 1280);
	update_option('medium_size_h', 960);
	update_option('medium_crop', 1);

	// This is only used internally by WP and isn't available to users, so don't use it
	// update_option('medium_large_size_w', 1600);
	// update_option('medium_large_size_h', 1200);
	// update_option('medium_large_crop', 1);

	update_option('large_size_w', 1920);
	update_option('large_size_h', 1080);
	update_option('large_crop', 1);

	# Add our own sizes (NOTE: Only when needed)
#	add_image_size('sleek-small', 120, 120, ['center', 'top']);
#	add_image_size('sleek-hd', 1920, 1080, ['center', 'top']);
});

# Also add them to the sizes dropdown in the admin
/* add_filter('image_size_names_choose', function ($sizes) {
	return array_merge($sizes, [
		'sleek-small' => __('Small', 'sleek_child')
	]);
}); */

# Register custom post types and taxonomies
$postTypes = ['movie', 'director'];

add_action('init', function () use ($postTypes) {
	# Post types
#	sleek_register_post_types($postTypes, 'sleek_child');

	# Taxonomies
/*	sleek_register_taxonomies([
		'genre' => ['movie'],
		'country' => ['movie', 'director']
	], 'sleek_child'); */

	# Array of CPTs that should appear in search (on top of post/page)
	# (run this function unless you want all your CPTs to appear)
	# sleek_set_cpt_in_search(['movie']);
});

# Add meta data (title, description, image) to CPTs
/* add_action('admin_menu', function () use ($postTypes) {
	sleek_register_post_type_meta_data($postTypes); # Pass in more fields as second argument (, ['subtitle' => 'text'])
}); */

# Register ACF
# Hide ACF from admin altogether (to prevent users from adding ACF from there)
# add_filter('acf/settings/show_admin', '__return_false');

# Register fields
add_action('acf/init', function () {
	# ACF in post types
/*	sleek_register_acf([
		'page' => ['page-meta', 'redirect-url', 'text-content'],
		'movie' => ['redirect-url']
	], 'sleek_child'); */

	# ACF in module containers
/*	sleek_register_acf_modules([
		'page' => [
			'below-content' => ['video', 'buttons', 'text-content'],
			'above-content' => ['video']
		],
		'movie' => [
			'right-of-content' => ['video'],
			'above-content' => ['video', 'buttons', 'text-content']
		]
	], 'sleek_child'); */

	# ACF in options pages
/*	sleek_register_acf_options([
		'theme-settings' => ['page-meta', 'redirect-url']
	], 'sleek_child'); */
});

# Register CSS and JS (automatically adds dist/all.css and dist/all.js which are generated by $ gulp)
add_action('init', function () {
	sleek_register_assets(); # Pass in more as array: ['https://fonts.googleapis.com/css?family=Lato:300,900']
});

# Register sidebars
/* add_action('init', function () {
	sleek_register_sidebars([
		'aside' => [
			'name' => __('Aside', 'sleek_child'),
			'before_title' => '<h3>',
			'after_title' => '</h3>'
		],
		'header' => __('Header', 'sleek_child'),
		'footer' => __('Footer', 'sleek_child')
	]);
}); */

# Add more options to Appearance -> Customize -> Theme Options
# (then use your options with get_theme_mod('option_name') any way you like)
/* add_action('customize_register', function ($wpCustomize) {
	sleek_register_theme_options($wpCustomize, [
		'option_name' => 'text'
	], 'sleek_child');
}); */

# Add more fields to users
/* add_filter('user_contactmethods', function () {
	$fields['tel'] = __('Telephone', 'sleek_child');
	$fields['facebook'] = __('Facebook', 'sleek_child');
	$fields['twitter'] = __('Twitter', 'sleek_child');
	$fields['instagram'] = __('Instagram', 'sleek_child');
	$fields['linkedin'] = __('LinkedIn', 'sleek_child');
	$fields['googleplus'] = __('Google+', 'sleek_child');
	$fields['stackoverflow'] = __('StackOverflow', 'sleek_child');
	$fields['github'] = __('GitHub', 'sleek_child');

	return $fields;
}); */

# Give pages excerpts
/* add_action('init', function () {
	add_post_type_support('page', 'excerpt');
}); */

# Set up for translation (put your mo/po-files in your-theme/languages/)
add_action('after_setup_theme', function () {
	load_child_theme_textdomain('sleek_child', get_stylesheet_directory() . '/languages');

	# If you want to override parent theme translations, add them to languages/sleek/lang_Code.po and uncomment this:
	# load_theme_textdomain('sleek', get_stylesheet_directory() . '/languages/sleek');
});

# Allow shortcodes in Text Widgets
/* add_action('init', function () {
	add_filter('widget_text', 'do_shortcode');
}); */

# Allow HTML in Widget Titles (with [tags])
# add_filter('widget_title', 'sleek_html_in_widget_titles');

# Allow Markdown in excerpts and ACF
# add_action('init', 'sleek_more_markdown');

# Add a 'post_type' argument to get_terms()
# add_filter('terms_clauses', 'sleek_terms_clauses', 10, 3);
